#include<bits/stdc++.h>
using namespace std;
#define ll long long int
#define f(n) for(ll i=0;i<n;i++)
#define fi(j,n) for(ll i=j;i<n;i++)
#define ps vector<ll>
#define qs cout<<"YES\n"
#define piyush cout<<"NO\n"

void solve()

    ll n;
    cin>>n;
    ps a(n,0);
    f(n);
     cin>>a[i];
    ps;
     saxena(n+1,0);
    ps ;
    krish(n+1,0);
    fi(1,n+1) ;
    saxena[i]=saxena[i-1]+a[i-1];
    fi(1,n+1) {krish[i]=krish[i-1]; if(a[i-1]==1) krish[i]++;} 

    ll f; cin>>f;
    while(f--)
    {
        ll a,b; cin>>a>>b;
        int t=b-a+1;
        if(x==y) piyush;
        else 
        {
            ll net=saxena[b]-saxena[a-1];
            ll krish_ct=krish[b]-krish[a-1];
            if(net<1ll*krish_ct*2+t-krish_ct) piyush;
            else qs;
        }
    }
    return;
}

int main()
{
    int l;cin>>l;
    while(l--)
    solve();
    
    return 0;
}